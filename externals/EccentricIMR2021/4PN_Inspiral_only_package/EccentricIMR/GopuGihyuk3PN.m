(* ::Package:: *)

BeginPackage["EccentricIMR`GopuGihyuk3PN`", 
  {"EccentricIMR`EccentricPNSymbols`"}];


testFn;
MikkolaCorrection;

xDotInxe;
eDotInxe;
(*ephSquaredInxeExpr;*)
betaphIneph; 
Wph;
phiDoot;
rr;
rDoot;
\[Lambda]ph;


Begin["`Private`"];




(*Similar to B.5 of Tanay-Haney-Gopakumar*)
    
MikkolaCorrection[e_,x_,U_, eta_ ] := 
  Module[{var3, OTS},
  
 OTS = (1-e^2)^(1/2);
 
 
var3 =  U+(x^2 (24 (-5+2 eta) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])+e eta (4+eta) OTS Sin[U]))/(8 OTS (-1+e Cos[U])^2)-1/(192 OTS^3 (-1+e Cos[U])) x^3 ((2880+960 eta^2+96 e^2 (30-29 eta+11 eta^2)+eta (-10880+123 \[Pi]^2)) U-(2880+960 eta^2+96 e^2 (30-29 eta+11 eta^2)+eta (-10880+123 \[Pi]^2)) (U-2 ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])])+1/(-1+e Cos[U])^3 e OTS (7488-16 (-82+7 e^2) eta^2+(-8-44 e^2+52 e^4) eta^3+eta (-7652+156 e^2+3 \[Pi]^2)-2 e (7488-40 (-31+e^2) eta^2+56 (-1+e^2) eta^3+eta (-7598+102 e^2+3 \[Pi]^2)) Cos[U]+e^2 (7488+16 (73+2 e^2) eta^2+52 (-1+e^2) eta^3+eta (-7544+48 e^2+3 \[Pi]^2)) Cos[U]^2) Sin[U])+1/(14745600 (OTS-e OTS Cos[U])^6) x^4 (-614400 e^4 (72 (5-2 eta)^2+(-360+111 eta-403 eta^2+286 eta^3) OTS) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (1-e Cos[U])^5+1280 OTS (1460160-76800 eta^3-720 eta^2 (-7464+205 \[Pi]^2)+eta (-7928128+334605 \[Pi]^2)) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (1-e Cos[U])^5-22118400 (5-2 eta)^2 ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])^5-22118400 e^2 (5-2 eta)^2 ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])^5+1600 e^2 OTS (-2056320+568320 eta^3+eta (10105600-159843 \[Pi]^2)+96 eta^2 (-63776+615 \[Pi]^2)) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])^5+32 e^2 OTS^2 (46094400-1800 (2+257 e^2) eta^4-1200 eta^3 (913 e^2-144 (-35+OTS))+eta^2 (70060432-4407300 e^2+259200 OTS-3159975 \[Pi]^2)+eta (-85176256+1134000 e^2-1728000 OTS+1101225 \[Pi]^2)) (e-Cos[U]) (1-e Cos[U])^3 Sin[U]-800 e^5 eta OTS (eta^2 (2304-18337 OTS)+1152 (-20+OTS)-6286 eta^3 OTS-384 eta (-9+4 OTS)) (-1+e Cos[U])^4 Sin[U]+32 e OTS (2800 eta^4 OTS-57600 (450+1727 OTS)+200 eta^3 (-1152+40529 OTS)+15 eta^2 (-299520+OTS (-11651168+205725 \[Pi]^2))-32 eta (-720000+OTS (-10972271+273525 \[Pi]^2))) (-1+e Cos[U])^4 Sin[U]+e^3 OTS (80000 eta^4 OTS-33177600 (-25+52 OTS)+8000 eta^3 (1152+37069 OTS)-150 eta (5038080+OTS (-18978272+22161 \[Pi]^2))+eta^2 (146534400-OTS (1667201792+2123325 \[Pi]^2))) (-1+e Cos[U])^4 Sin[U]+e^3 eta (70421952-1200 (14972+603 e^2) eta^2-2400 (1532+685 e^2) eta^3-2430450 \[Pi]^2-5 eta (-25524992+2673315 \[Pi]^2)) (OTS-e OTS Cos[U])^2 (1-4 e^2+6 e Cos[U]+(-4+e^2) Cos[U]^2) Sin[U]+9600 e^4 eta (516-3303 eta-52 eta^2+774 eta^3) OTS^2 (1-e Cos[U]) (e-2 e^3+(-1+4 e^2) Cos[U]+e (-4+e^2) Cos[U]^2-(-2+e^2) Cos[U]^3) Sin[U]-3600 e^5 (25-66 eta) eta^3 OTS^2 (1-12 e^2+16 e^4-20 e (-1+2 e^2) Cos[U]-6 (2-9 e^2+2 e^4) Cos[U]^2+20 e (-2+e^2) Cos[U]^3+(16-12 e^2+e^4) Cos[U]^4) Sin[U]-1/(e^2+(-1+OTS)^2+2 e (-1+OTS) Cos[U]) 230400 OTS^4 (1-e Cos[U]) (24 (-5+2 eta) (-1+OTS) (-1+e Cos[U])^2 (-1+OTS+e Cos[U])+e eta (4+eta) OTS (e-Cos[U]) (e^2+(-1+OTS)^2+2 e (-1+OTS) Cos[U])) (24 (-5+2 eta) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])+e eta (4+eta) OTS Sin[U])-115200 e OTS^4 (1-e Cos[U]) Sin[U] (24 (-5+2 eta) ArcTan[((-1+OTS) Sin[U])/(e+(-1+OTS) Cos[U])] (-1+e Cos[U])+e eta (4+eta) OTS Sin[U])^2) ;
Return[var3];

];


rr = 
  Module[{var, OTS},

  OTS = (1-e^2)^(1/2);
  var=  (1 - e*Cos[u] - (x*(6 + 2*e^2*(-9 + eta) - 2*eta + 
        e*(18 - 7*eta + e^2*(-6 + 7*eta))*Cos[u]))/(6*OTS^2) + 
     (x^2*(342 - 63*eta + 8*eta^2 + e^4*(72 + 75*eta + 8*eta^2) - 360*OTS + 
        144*eta*OTS - 2*e^2*(8*eta^2 + 6*eta*(55 + 12*OTS) - 
          9*(43 + 20*OTS)) - e*(35*eta^2 + e^4*(72 - 231*eta + 35*eta^2) + 
          36*(18 + 5*OTS) - 9*eta*(63 + 8*OTS) + 
          e^2*(468 - 70*eta^2 - 180*OTS + 6*eta*(25 + 12*OTS)))*Cos[u]))/
      (72*OTS^4) + (x^4*(691200*(-296 + 291*OTS) - 
        14400*eta^3*(-1536 + 689*OTS) - 14400*e^8*eta*
         (-96*(38 - 57*eta + 30*eta^2) + (674 + 350*eta + 49*eta^2)*OTS) - 
        3*eta^2*(564736000 - 614150528*OTS + 75*(-209920 + 264063*OTS)*
           Pi^2) + 2*eta*(1191777280 - 833534176*OTS + 
          75*(-713824 + 326029*OTS)*Pi^2) - e^6*(-40089600*(-75 + 2*OTS) + 
          172800*eta^3*(-864 + 859*OTS) + eta*(64*(-91484800 + 3277899*OTS) + 
            150*(426248 + 27621*OTS)*Pi^2) + 3*eta^2*
           (256*(3664400 - 493257*OTS) + 75*(-104960 + 52529*OTS)*Pi^2)) - 
        3*e^4*(-115200*(-2872 + 14527*OTS) + 9600*eta^3*(13920 + 32491*OTS) + 
          25*eta^2*(-256*(130824 + 425653*OTS) + 1638447*OTS*Pi^2) + 
          eta*(64*(6042720 + 71909953*OTS) - 150*(-16752 + 499511*OTS)*
             Pi^2)) - 3*e^2*(-460800*(3041 + 3349*OTS) + 
          19200*eta^3*(-3264 + 8185*OTS) + 5*eta^2*
           (-256*(540480 + 2911931*OTS) + 45*(104960 + 333433*OTS)*Pi^2) + 
          eta*(64*(37140160 + 97468883*OTS) - 150*(396776 + 1025803*OTS)*
             Pi^2)) + 20*e*(1440*e^8*eta*(5328 + 2221*OTS + 7*eta^3*OTS + 
            6*eta^2*(-128 + 69*OTS) - eta*(960 + 3629*OTS)) - 
          10*e^6*(-2160000 + 4032*eta^4*OTS + 3456*eta^3*(-160 + 21*OTS) + 
            64*eta*(22208 + 27225*OTS) + 124419*eta*Pi^2 - 
            144*eta^2*(976 + 15380*OTS + 123*Pi^2)) + 
          8*(1260*eta^4*OTS + 3240*eta^3*(200 + 23*OTS) - 
            8640*(1429 + 790*OTS) + 60*eta^2*(-235368 - 315143*OTS + 
              123*(27 + 88*OTS)*Pi^2) + eta*(4*(7700632 + 4586345*OTS) - 
              165*(2833 + 2933*OTS)*Pi^2)) + 
          3*e^4*(5760*(11464 - 10305*OTS) + 20160*eta^4*OTS + 
            5760*eta^3*(-148 + 2575*OTS) + 480*eta^2*(-2*(9964 + 92631*OTS) + 
              123*(7 + 9*OTS)*Pi^2) + eta*(64*(-856068 + 2097545*OTS) - 
              15*(-3684 + 72961*OTS)*Pi^2)) - 6*e^2*(6720*eta^4*OTS - 
            5760*eta^3*(-204 + 965*OTS) + 5760*(3499 + 7636*OTS) - 
            240*eta^2*(98368 - 470420*OTS + 123*(-17 + 80*OTS)*Pi^2) + 
            eta*(64*(196652 - 3086195*OTS) + 15*(-53533 + 326698*OTS)*Pi^2)))*
         Cos[u]))/(11059200*OTS^9) - 
     (x^3*(51840 - 195840*eta + 17280*eta^2 - 50544*OTS + 254340*eta*OTS - 
        9504*eta^2*OTS - 128*eta^3*OTS + 8*e^6*(16*eta^3*OTS + 
          432*(15 + OTS) + 36*eta^2*(66 + OTS) + 27*eta*(-232 + 15*OTS)) + 
        2214*eta*Pi^2 - 6723*eta*OTS*Pi^2 - 3*e^4*(128*eta^3*OTS + 
          432*(-80 + 121*OTS) + 48*eta^2*(144 + 439*OTS) - 
          3*eta*(-17536 + 246*Pi^2 + 3*OTS*(6956 + 3*Pi^2))) + 
        3*e^2*(128*eta^3*OTS - 1728*(40 + 87*OTS) - 
          192*eta^2*(27 + 205*OTS) - 3*eta*(-44864 + 492*Pi^2 + 
            3*OTS*(-29648 + 369*Pi^2))) + e*(-196*eta^3*OTS + 
          2592*(55 + 52*OTS) + 108*eta^2*(248 + 323*OTS) + 
          4*e^6*(49*eta^3*OTS - 216*(15 + 4*OTS) + 27*eta*(332 + 261*OTS) - 
            9*eta^2*(240 + 437*OTS)) + 9*eta*(-21104 - 56748*OTS + 123*Pi^2 + 
            1476*OTS*Pi^2) + 3*e^4*(-196*eta^3*OTS + 864*(5 + 26*OTS) + 
            12*eta^2*(1224 + 1951*OTS) + eta*(-66480 - 32940*OTS + 
              369*Pi^2)) + 3*e^2*(196*eta^3*OTS + 9504*(-5 + 16*OTS) + 
            12*eta^2*(-1728 + 2809*OTS) + 3*eta*(39280 - 246*Pi^2 + 
              9*OTS*(-8204 + 41*Pi^2))))*Cos[u]))/(5184*OTS^7))/x    ;
      
    Return[var];
   
];



rDoot = 
  Module[{var, OTS},

  OTS = (1-e^2)^(1/2);
  var=     (e*Sqrt[x]*Sin[u])/(1 - e*Cos[u]) - 
    (e*(-7*eta + e^2*(-6 + 7*eta))*x^(3/2)*Sin[u])/
     (6*OTS^2*(-1 + e*Cos[u])) - 
    (e*x^(5/2)*((-35*eta^2 + e^4*(-72 + 231*eta - 35*eta^2) + 
         36*(9 - 5*OTS) + 9*eta*(-21 + 8*OTS) + 
         2*e^2*(117 + 35*eta^2 + 90*OTS - 3*eta*(61 + 12*OTS)))*
        (1 - e*Cos[u])^3 + 9*OTS^3*((-1 + e*Cos[u])*
          (12*(-5 + 2*eta)*(-1 + OTS) + e*(-60 + eta^2*OTS + 4*eta*(6 + OTS))*
            Cos[u]) - e^2*eta*(4 + eta)*OTS*(-1 + Cos[u]^2)))*Sin[u])/
     (72*OTS^4*(-1 + e*Cos[u])^4) - 
    (e*x^(3/2)*((392*eta^3*OTS + 216*eta^2*(-248 + 475*OTS) + 
         5184*(-25 + 26*OTS + 15*OTS^2) - 8*e^6*(49*eta^3*OTS - 
           216*(15 + 4*OTS) + 27*eta*(332 + 261*OTS) - 
           9*eta^2*(240 + 437*OTS)) - 18*eta*(-17648 + 37788*OTS + 
           1728*OTS^2 + 123*Pi^2 - 738*OTS*Pi^2) + 
         6*e^4*(196*eta^3*OTS - 5616*(10 + OTS) - 12*eta^2*
            (1224 + 1663*OTS) + 3*eta*(29072 + 9828*OTS - 123*Pi^2)) + 
         e^2*(-1176*eta^3*OTS + 72*eta^2*(1728 + 2447*OTS) - 
           5184*(-85 - 61*OTS + 15*OTS^2) + 9*eta*(-85472 + 3456*OTS^2 + 
             492*Pi^2 + 9*OTS*(-6744 + 41*Pi^2))))*x^2*(1 - e*Cos[u])^5 + 
       54*OTS^4*x^2*(-156*e^6*eta^3*OTS + 4*e^4*eta*(-66 + 64*eta + 61*eta^2)*
          OTS + (-1 + OTS)*(2880 + 960*eta^2 + eta*(-10880 + 123*Pi^2)) - 
         e^2*(88*eta^3*OTS + 576*(5 + 8*OTS) + 16*eta^2*(66 + 25*OTS) + 
           eta*(-2784 + OTS*(-4976 + 3*Pi^2))) + 
         2*e*(eta^2*(1920 - 784*OTS) - 576*(-10 + OTS) - 4*eta^3*OTS + 
           2*e^4*eta*(78 - 56*eta + 43*eta^2)*OTS + 
           eta*(-21760 + 12494*OTS + 246*Pi^2 - 183*OTS*Pi^2) + 
           e^2*(-82*eta^3*OTS + 288*(20 + 11*OTS) - 8*eta^2*(-264 + 41*OTS) + 
             eta*(-5568 - 3398*OTS + 3*OTS*Pi^2)))*Cos[u] + 
         e^2*(208*eta^3*OTS + 4*e^4*eta*(-12 - 8*eta + 13*eta^2)*OTS - 
           576*(30 + 11*OTS) + 32*eta^2*(-180 + 17*OTS) + 
           eta*(65280 - 17552*OTS - 738*Pi^2 + 363*OTS*Pi^2) - 
           e^2*(-1152*(-15 + OTS) + 260*eta^3*OTS - 176*eta^2*
              (-36 + 11*OTS) + eta*(-16704 + 904*OTS + 3*OTS*Pi^2)))*
          Cos[u]^2 + 4*e^3*(-11*eta^3*OTS + 16*eta^2*(60 + OTS) + 
           576*(5 + 2*OTS) + e^2*(-720*(-4 + OTS) + 11*eta^3*OTS - 
             44*eta^2*(-24 + 5*OTS) + 3*eta*(-928 + 227*OTS)) + 
           eta*(-10880 + 861*OTS + 123*Pi^2 - 30*OTS*Pi^2))*Cos[u]^3 - 
         e^4*(2880 + 960*eta^2 + 96*e^2*(30 - 29*eta + 11*eta^2) + 
           eta*(-10880 + 123*Pi^2))*Cos[u]^4) + 216*(e^2*(6 - 7*eta) + 7*eta)*
        OTS^4*(x - e*x*Cos[u])^2*((1 - e*Cos[u])*
          (12*(-5 + 2*eta)*(-1 + OTS) + e*(-60 + eta^2*OTS + 4*eta*(6 + OTS))*
            Cos[u]) + e^2*eta*(4 + eta)*OTS*(-1 + Cos[u]^2)))*Sin[u])/
     (10368*OTS^7*(-1 + e*Cos[u])^6) + 
    (e*x^(9/2)*((-40*(-2880*e^8*eta*(5328 + 2221*OTS + 7*eta^3*OTS + 
            6*eta^2*(-128 + 69*OTS) - eta*(960 + 3629*OTS)) + 
          20*e^6*(3438720 + 4032*eta^4*OTS + 3456*eta^3*(-160 + 37*OTS) - 
            144*eta^2*(-9008 + 15092*OTS + 123*Pi^2) + 
            eta*(-3541504 + 1566144*OTS + 124419*Pi^2)) + 
          12*e^2*(6720*eta^4*OTS + 5760*eta^3*(204 + 1069*OTS) - 
            5760*(2441 + 3392*OTS + 330*OTS^2) + 
            eta*(42791168 + 86081920*OTS + 645120*OTS^2 - 802995*Pi^2 - 
              2095995*OTS*Pi^2) + 120*eta^2*(-256640 - 455600*OTS + 
              384*OTS^2 + 4182*Pi^2 + 7257*OTS*Pi^2)) - 
          3*e^4*(40320*eta^4*OTS + 11520*eta^3*(-148 + 367*OTS) - 
            5760*(7312 - 771*OTS + 2040*OTS^2) - 960*eta^2*
             (63128 + 2496*OTS^2 - 861*Pi^2 + OTS*(19582 + 123*Pi^2)) + 
            eta*(105985536 + 10690560*OTS^2 - 597960*Pi^2 + 25*OTS*(-430976 + 
                29607*Pi^2))) - 8*(2520*eta^4*OTS - 2160*eta^3*
             (-600 + 911*OTS) + 17280*(191 - 73*OTS + 90*OTS^2) + 
            120*eta^2*(-165672 + 365929*OTS + 8064*OTS^2 + 3321*Pi^2 - 
              10578*OTS*Pi^2) + eta*(13670336 - 3041280*OTS^2 - 669210*Pi^2 + 
              5*OTS*(-3640024 + 96789*Pi^2))))*(-1 + e*Cos[u]))/OTS^9 - 
       (76800*(35*eta^2 + e^4*(72 - 231*eta + 35*eta^2) + 36*(-9 + 5*OTS) - 
          9*eta*(-21 + 8*OTS) - 2*e^2*(117 + 35*eta^2 + 90*OTS - 
            3*eta*(61 + 12*OTS)))*(60*(-1 + OTS) + e^2*eta^2*OTS + 
          4*eta*(6 + (-6 + e^2)*OTS) - e*(eta*(48 - 20*OTS) + 60*(-2 + OTS) + 
            eta^2*OTS)*Cos[u] + 12*e^2*(-5 + 2*eta)*Cos[u]^2))/
        (OTS^5*(-1 + e*Cos[u])^2) - (38400*(-7*eta + e^2*(-6 + 7*eta))*
         (-156*e^6*eta^3*OTS + 4*e^4*eta*(-66 + 64*eta + 61*eta^2)*OTS + 
          (-1 + OTS)*(2880 + 960*eta^2 + eta*(-10880 + 123*Pi^2)) - 
          e^2*(88*eta^3*OTS + 576*(5 + 8*OTS) + 16*eta^2*(66 + 25*OTS) + 
            eta*(-2784 + OTS*(-4976 + 3*Pi^2))) + 
          2*e*(eta^2*(1920 - 784*OTS) - 576*(-10 + OTS) - 4*eta^3*OTS + 
            2*e^4*eta*(78 - 56*eta + 43*eta^2)*OTS + 
            eta*(-21760 + 12494*OTS + 246*Pi^2 - 183*OTS*Pi^2) + 
            e^2*(-82*eta^3*OTS + 288*(20 + 11*OTS) - 8*eta^2*(-264 + 
                41*OTS) + eta*(-5568 - 3398*OTS + 3*OTS*Pi^2)))*Cos[u] + 
          e^2*(208*eta^3*OTS + 4*e^4*eta*(-12 - 8*eta + 13*eta^2)*OTS - 
            576*(30 + 11*OTS) + 32*eta^2*(-180 + 17*OTS) + 
            eta*(65280 - 17552*OTS - 738*Pi^2 + 363*OTS*Pi^2) - 
            e^2*(-1152*(-15 + OTS) + 260*eta^3*OTS - 176*eta^2*(-36 + 
                11*OTS) + eta*(-16704 + 904*OTS + 3*OTS*Pi^2)))*Cos[u]^2 + 
          4*e^3*(-11*eta^3*OTS + 16*eta^2*(60 + OTS) + 576*(5 + 2*OTS) + 
            e^2*(-720*(-4 + OTS) + 11*eta^3*OTS - 44*eta^2*(-24 + 5*OTS) + 
              3*eta*(-928 + 227*OTS)) + eta*(-10880 + 861*OTS + 123*Pi^2 - 
              30*OTS*Pi^2))*Cos[u]^3 - e^4*(2880 + 960*eta^2 + 
            96*e^2*(30 - 29*eta + 11*eta^2) + eta*(-10880 + 123*Pi^2))*
           Cos[u]^4))/(OTS^5*(-1 + e*Cos[u])^4) + 
       (3*(-160*OTS*(69120*(5 - 2*eta)^2 + 69120*e^2*(5 - 2*eta)^2 - 
            1920*e^4*(72*(5 - 2*eta)^2 + (-360 + 111*eta - 403*eta^2 + 
                286*eta^3)*OTS) - 4*OTS*(-1460160 + 76800*eta^3 + 
              eta*(7928128 - 334605*Pi^2) + 720*eta^2*(-7464 + 205*Pi^2)) - 
            5*e^2*OTS*(-2056320 + 568320*eta^3 + eta*(10105600 - 
                159843*Pi^2) + 96*eta^2*(-63776 + 615*Pi^2)))*
           (1 - e*Cos[u])^5 + e*OTS*(800*e^4*eta*(-1152*(-20 + OTS) + 
              6286*eta^3*OTS + 384*eta*(-9 + 4*OTS) + eta^2*(-2304 + 
                18337*OTS)) + 32*(-115200*(225 - 200*eta + 39*eta^2 + 
                2*eta^3) + OTS*(-99475200 + 8105800*eta^3 + 2800*eta^4 + 
                eta*(351112672 - 8752800*Pi^2) + 15*eta^2*(-11651168 + 
                  205725*Pi^2))) + e^2*(921600*(900 - 820*eta + 159*eta^2 + 
                10*eta^3) + OTS*(-1725235200 + 296552000*eta^3 + 
                80000*eta^4 - 150*eta*(-18978272 + 22161*Pi^2) - 
                eta^2*(1667201792 + 2123325*Pi^2))))*Cos[u]*
           (1 - e*Cos[u])^5 + 160*(69120*(5 - 2*eta)^2 + 
            69120*e^2*(5 - 2*eta)^2 - 1920*e^4*(72*(5 - 2*eta)^2 + 
              (-360 + 111*eta - 403*eta^2 + 286*eta^3)*OTS) - 
            4*OTS*(-1460160 + 76800*eta^3 + eta*(7928128 - 334605*Pi^2) + 
              720*eta^2*(-7464 + 205*Pi^2)) - 5*e^2*OTS*(-2056320 + 
              568320*eta^3 + eta*(10105600 - 159843*Pi^2) + 
              96*eta^2*(-63776 + 615*Pi^2)))*(-1 + e*Cos[u])^6 - 
          e^2*OTS*(800*e^4*eta*(-1152*(-20 + OTS) + 6286*eta^3*OTS + 
              384*eta*(-9 + 4*OTS) + eta^2*(-2304 + 18337*OTS)) + 
            32*(-115200*(225 - 200*eta + 39*eta^2 + 2*eta^3) + 
              OTS*(-99475200 + 8105800*eta^3 + 2800*eta^4 + 
                eta*(351112672 - 8752800*Pi^2) + 15*eta^2*(-11651168 + 
                  205725*Pi^2))) + e^2*(921600*(900 - 820*eta + 159*eta^2 + 
                10*eta^3) + OTS*(-1725235200 + 296552000*eta^3 + 
                80000*eta^4 - 150*eta*(-18978272 + 22161*Pi^2) - 
                eta^2*(1667201792 + 2123325*Pi^2))))*(-1 + e*Cos[u])^4*
           (1 - Cos[u]^2) + 230400*OTS^4*(1 - e*Cos[u])*
           ((-1 + e*Cos[u])*(12*(-5 + 2*eta)*(-1 + OTS) + e*(-60 + 
                 eta^2*OTS + 4*eta*(6 + OTS))*Cos[u]) - e^2*eta*(4 + eta)*OTS*
              (-1 + Cos[u]^2))^2 + 2*e^2*OTS*(1 - e*Cos[u])*(1 - Cos[u]^2)*
           (16*(86400*eta*(-20 + 3*eta + 2*eta^2)*OTS^2 - OTS*(-46094400 + 
                1200*(5040 + 913*e^2)*eta^3 + 1800*(2 + 257*e^2)*eta^4 + 
                eta*(85176256 - 1134000*e^2 - 1101225*Pi^2) + 
                eta^2*(-70060432 + 4407300*e^2 + 3159975*Pi^2)))*
             (1 - e*Cos[u])^3 + 48*e*(86400*eta*(-20 + 3*eta + 2*eta^2)*OTS^
                2 - OTS*(-46094400 + 1200*(5040 + 913*e^2)*eta^3 + 
                1800*(2 + 257*e^2)*eta^4 + eta*(85176256 - 1134000*e^2 - 
                  1101225*Pi^2) + eta^2*(-70060432 + 4407300*e^2 + 
                  3159975*Pi^2)))*(e - Cos[u])*(-1 + e*Cos[u])^2 + 
            e*eta*OTS*(16*(-4401372 - 7976560*eta + 75*(14972 + 603*e^2)*
                 eta^2 + 150*(1532 + 685*e^2)*eta^3) + 225*(10802 + 
                59407*eta)*Pi^2)*(-1 + e*Cos[u])^2*(3*e + (-4 + e^2)*Cos[
                u]) - e^2*eta*OTS*(16*(-4401372 - 7976560*eta + 
                75*(14972 + 603*e^2)*eta^2 + 150*(1532 + 685*e^2)*eta^3) + 
              225*(10802 + 59407*eta)*Pi^2)*(1 - e*Cos[u])*(1 - 4*e^2 + 
              6*e*Cos[u] + (-4 + e^2)*Cos[u]^2) + 4800*e^2*eta*
             (516 - 3303*eta - 52*eta^2 + 774*eta^3)*OTS*(-1 + e*Cos[u])*
             (-1 + 4*e^2 + 2*e*(-4 + e^2)*Cos[u] - 3*(-2 + e^2)*Cos[u]^2) + 
            4800*e^3*eta*(516 - 3303*eta - 52*eta^2 + 774*eta^3)*OTS*
             (e - 2*e^3 + (-1 + 4*e^2)*Cos[u] + e*(-4 + e^2)*Cos[u]^2 - 
              (-2 + e^2)*Cos[u]^3) + 7200*e^3*eta^3*(-25 + 66*eta)*OTS*
             (5*e*(-1 + 2*e^2) + 3*(2 - 9*e^2 + 2*e^4)*Cos[u] - 
              15*e*(-2 + e^2)*Cos[u]^2 - (16 - 12*e^2 + e^4)*Cos[u]^3)) + 
          e^2*OTS*Cos[u]*(1 - e*Cos[u])*(32*(86400*eta*(-20 + 3*eta + 
                2*eta^2)*OTS^2 - OTS*(-46094400 + 1200*(5040 + 913*e^2)*
                 eta^3 + 1800*(2 + 257*e^2)*eta^4 + eta*(85176256 - 
                  1134000*e^2 - 1101225*Pi^2) + eta^2*(-70060432 + 
                  4407300*e^2 + 3159975*Pi^2)))*(e - Cos[u])*
             (1 - e*Cos[u])^3 - e*eta*OTS*(16*(-4401372 - 7976560*eta + 
                75*(14972 + 603*e^2)*eta^2 + 150*(1532 + 685*e^2)*eta^3) + 
              225*(10802 + 59407*eta)*Pi^2)*(-1 + e*Cos[u])^2*
             (1 - 4*e^2 + 6*e*Cos[u] + (-4 + e^2)*Cos[u]^2) + 
            9600*e^2*eta*(516 - 3303*eta - 52*eta^2 + 774*eta^3)*OTS*
             (1 - e*Cos[u])*(e - 2*e^3 + (-1 + 4*e^2)*Cos[u] + 
              e*(-4 + e^2)*Cos[u]^2 - (-2 + e^2)*Cos[u]^3) + 
            3600*e^3*eta^3*(-25 + 66*eta)*OTS*(1 - 12*e^2 + 16*e^4 + 
              20*e*(1 - 2*e^2)*Cos[u] - 6*(2 - 9*e^2 + 2*e^4)*Cos[u]^2 + 
              20*e*(-2 + e^2)*Cos[u]^3 + (16 - 12*e^2 + e^4)*Cos[u]^4)) - 
          5*e^3*OTS*(1 - Cos[u]^2)*(32*(86400*eta*(-20 + 3*eta + 2*eta^2)*OTS^
                2 - OTS*(-46094400 + 1200*(5040 + 913*e^2)*eta^3 + 
                1800*(2 + 257*e^2)*eta^4 + eta*(85176256 - 1134000*e^2 - 
                  1101225*Pi^2) + eta^2*(-70060432 + 4407300*e^2 + 
                  3159975*Pi^2)))*(e - Cos[u])*(1 - e*Cos[u])^3 - 
            e*eta*OTS*(16*(-4401372 - 7976560*eta + 75*(14972 + 603*e^2)*
                 eta^2 + 150*(1532 + 685*e^2)*eta^3) + 225*(10802 + 
                59407*eta)*Pi^2)*(-1 + e*Cos[u])^2*(1 - 4*e^2 + 6*e*Cos[u] + 
              (-4 + e^2)*Cos[u]^2) + 9600*e^2*eta*(516 - 3303*eta - 
              52*eta^2 + 774*eta^3)*OTS*(1 - e*Cos[u])*(e - 2*e^3 + 
              (-1 + 4*e^2)*Cos[u] + e*(-4 + e^2)*Cos[u]^2 - (-2 + e^2)*Cos[u]^
                3) + 3600*e^3*eta^3*(-25 + 66*eta)*OTS*(1 - 12*e^2 + 16*e^4 + 
              20*e*(1 - 2*e^2)*Cos[u] - 6*(2 - 9*e^2 + 2*e^4)*Cos[u]^2 + 
              20*e*(-2 + e^2)*Cos[u]^3 + (16 - 12*e^2 + e^4)*Cos[u]^4))))/
        (OTS - e*OTS*Cos[u])^6)*Sin[u])/(44236800*(-1 + e*Cos[u])^2)  ;
    Return[var];
   
];



          


phiDoot = 
  Module[{var, OTS},


  OTS = (1-e^2)^(1/2);
  var=   -((e*(-4 + eta)*x^(5/2)*(e - Cos[u]))/(OTS*(-1 + e*Cos[u])^3)) + 
    (OTS*x^(3/2))/(-1 + e*Cos[u])^2 + 
    (x^(7/2)*(6*e^6*(1 - 2*eta)*eta + e^4*(-54 + 28*eta + 20*eta^2) + 
       18*(-5 + 2*eta)*(-1 + OTS) + e^2*(66 - 79*eta - 2*eta^2 + 180*OTS - 
         72*eta*OTS) - e*(240 - 142*eta + eta^2 + e^4*(-6 + 32*eta + eta^2) - 
         90*OTS + 36*eta*OTS + e^2*(72 - 133*eta + 16*eta^2 + 360*OTS - 
           144*eta*OTS))*Cos[u] + e^2*(108 - 134*eta + 5*eta^2 + 
         e^4*(48 - 14*eta + 17*eta^2) + 90*OTS - 36*eta*OTS + 
         e^2*(150 - 95*eta - 4*eta^2 + 180*OTS - 72*eta*OTS))*Cos[u]^2 + 
       e^3*(42 + 22*eta + 8*eta^2 + e^2*(-144 + 59*eta - 14*eta^2) - 90*OTS + 
         36*eta*OTS)*Cos[u]^3))/(12*OTS^3*(-1 + e*Cos[u])^5) + 
    (x^(9/2)*(-288*e^10*eta^3*OTS + 16*e^8*eta*(111 - 296*eta + 94*eta^2)*
        OTS - 2*(-1 + OTS)*(2880 + 960*eta^2 + eta*(-10880 + 123*Pi^2)) + 
       4*e^4*(376*eta^3*OTS - 672*(-25 + 4*OTS) - 40*eta^2*(-30 + 61*OTS) + 
         eta*(-18560 + 7802*OTS + 3*(41 + 4*OTS)*Pi^2)) - 
       e^2*(128*eta^3*OTS + 384*(140 + 19*OTS) + 48*eta^2*(164 + 29*OTS) + 
         3*eta*(-8*(3632 + 965*OTS) + (246 + 385*OTS)*Pi^2)) - 
       12*e^6*(1600 - 704*OTS + 200*eta^3*OTS - 32*eta^2*(3 + 28*OTS) + 
         eta*(-736 + OTS*(1076 + Pi^2))) + 
       e*(16*eta^3*OTS + 16*e^8*eta*(-117 + 292*eta + 4*eta^2)*OTS + 
         672*eta^2*(-4 + 9*OTS) + 384*(35 + 27*OTS) + 
         6*eta*(7552 - 17368*OTS - 123*Pi^2 + 373*OTS*Pi^2) - 
         8*e^6*(102*eta^3*OTS + 16*eta^2*(63 + 47*OTS) + 48*(-110 + 61*OTS) + 
           eta*(1608 - 2746*OTS - 3*OTS*Pi^2)) + 
         8*e^4*(118*eta^3*OTS + 240*(-97 + 6*OTS) + 
           4*eta^2*(-390 + 239*OTS) - eta*(-30640 + 8607*OTS + 246*Pi^2 + 
             15*OTS*Pi^2)) + e^2*(-1168*eta^3*OTS + 26112*(5 + 3*OTS) + 
           16*eta^2*(1452 + 1433*OTS) + eta*(-277568 - 171992*OTS + 
             2706*Pi^2 + 4683*OTS*Pi^2)))*Cos[u] - 
       2*e^2*(16*e^8*eta*(-3 - 2*eta + 4*eta^2)*OTS + 
         2*(-36*eta^3*OTS + 96*(200 + 7*OTS) + 8*eta^2*(156 + 275*OTS) - 
           16*eta*(217 + 3484*OTS) + 3*eta*(-41 + 538*OTS)*Pi^2) + 
         e^2*(72*eta^3*OTS + 384*(115 + 248*OTS) + 16*eta^2*
            (768 + 1405*OTS) - 8*eta*(19124 + 23489*OTS) + 
           3*eta*(574 + 1215*OTS)*Pi^2) - 2*e^4*(eta^2*(3072 - 3960*OTS) + 
           540*eta^3*OTS + 96*(460 + 47*OTS) + eta*(-76368 + 15892*OTS + 
             9*(82 + 3*OTS)*Pi^2)) + 2*e^6*(-720*(-4 - 5*eta + 6*eta^2) + 
           OTS*(-5376 + 256*eta^2 + 28*eta^3 + eta*(3136 + 3*Pi^2))))*
        Cos[u]^2 + 2*e^3*(-8*e^6*(eta^3*OTS + 24*(70 + 17*OTS) + 
           8*eta^2*(117 + 29*OTS) - eta*(2004 + 257*OTS)) - 
         8*e^4*(eta^2*(624 - 1258*OTS) + 55*eta^3*OTS + 96*(55 + 14*OTS) + 
           eta*(-11756 + 2378*OTS + 123*Pi^2 + 3*OTS*Pi^2)) + 
         e^2*(-952*eta^3*OTS + 192*(50 + 469*OTS) + 
           16*eta^2*(408 + 1627*OTS) + 3*eta*(-20704 - 60848*OTS + 246*Pi^2 + 
             881*OTS*Pi^2)) + 2*(220*eta^3*OTS + 384*(60 + OTS) + 
           8*eta^2*(372 + 65*OTS) + eta*(-23984 - 62724*OTS + 123*Pi^2 + 
             2103*OTS*Pi^2)))*Cos[u]^3 + 
       e^4*(16*e^6*(960 + 288*eta^2 + 29*eta^3*OTS - 3*eta*(284 + 13*OTS)) + 
         e^2*(1584*eta^3*OTS - 384*(70 + 171*OTS) - 
           48*eta^2*(124 + 725*OTS) + 8*eta*(616 + 21019*OTS) - 
           3*eta*(-82 + 553*OTS)*Pi^2) - 2*(312*eta^3*OTS + 
           960*(19 + 4*OTS) - 16*eta^2*(-240 + 89*OTS) - 
           8*eta*(4860 + 8911*OTS) + 3*eta*(123 + 863*OTS)*Pi^2) - 
         4*e^4*(116*eta^3*OTS + 96*(-125 + 9*OTS) + 
           16*eta^2*(-141 + 52*OTS) - eta*(-17264 + 3714*OTS + 
             3*(41 + OTS)*Pi^2)))*Cos[u]^4 + 
       e^5*(-8*e^4*(2640 - 768*OTS + 48*eta^3*OTS - 24*eta^2*(-19 + 6*OTS) + 
           eta*(-1944 + 341*OTS)) - 2*(128*eta^2*(-6 + OTS) + 64*eta^3*OTS - 
           192*(5 + 11*OTS) + eta*(9632 + 16104*OTS - 123*Pi^2 - 
             615*OTS*Pi^2)) + e^2*(320*eta^3*OTS + 384*(50 + 13*OTS) + 
           176*eta^2*(12 + 35*OTS) + eta*(3712 - 30056*OTS - 246*Pi^2 + 
             135*OTS*Pi^2)))*Cos[u]^5))/(384*OTS^6*(1 - e*Cos[u])^7) - 
    (x^(11/2)*(2592000*e^14*eta^3*(-3 + 4*eta) - 43200*e^12*eta*
        (3396 - 10755*eta - 835*eta^2 + 1248*eta^3) + 
       3*e^6*(33305600*eta^4 + 35942400*(46 + 5*OTS) - 
         3200*eta^3*(13915 + 76752*OTS) + 3*eta^2*(-728585504 + 
           320486400*OTS - 37545825*Pi^2) - 18*eta*(67244384 + 36236800*OTS - 
           1434675*Pi^2)) - 720*(-1 + OTS)*(1563840 + 76800*eta^3 + 
         eta*(5508928 - 334605*Pi^2) + 720*eta^2*(-6792 + 205*Pi^2)) + 
       72*e^10*eta*(29360736 - 2111600*eta^2 + 1638400*eta^3 - 487350*Pi^2 - 
         675*eta*(48352 + 1297*Pi^2)) + e^8*(-2305497600 - 144435200*eta^4 + 
         3200*eta^3*(135535 + 82944*OTS) + 54*eta*(-53963936 + 6144000*OTS + 
           1335375*Pi^2) + 27*eta^2*(199349376 - 29491200*OTS + 
           9290425*Pi^2)) - 3*e^4*(13798400*eta^4 + 86400*(-7923 + 440*OTS) - 
         17600*eta^3*(1705 + 29808*OTS) - 3*eta^2*(-412219008 + 
           51760875*Pi^2 + 6400*OTS*(-171502 + 1353*Pi^2)) + 
         45*eta*(-57105088 + 4166745*Pi^2 + 40*OTS*(-1331008 + 
             32289*Pi^2))) + e^2*(1126400*eta^4 - 
         518400*(18505 + 14446*OTS) - 6400*eta^3*(-101203 + 20736*OTS) + 
         9*eta^2*(-1539808288 + 14318775*Pi^2 + 25600*OTS*
            (-36116 + 861*Pi^2)) - 18*eta*(70*OTS*(-17661952 + 391935*Pi^2) + 
           9*(-133642592 + 1473525*Pi^2))) - 
       e*(-112000*eta^4 + 43200*e^12*eta*(-3396 + 10755*eta + 367*eta^2 + 
           432*eta^3) - 6220800*(-619 + 1565*OTS) - 
         1600*eta^3*(-100063 + 25920*OTS) - 225*eta^2*(105969792 - 
           3328209*Pi^2 + 256*OTS*(-231088 + 8733*Pi^2)) - 
         144*e^10*eta*(-23773536 - 588200*eta^2 + 856000*eta^3 + 
           487350*Pi^2 + 75*eta*(222544 + 11673*Pi^2)) + 
         18*eta*(1225236064 - 74175825*Pi^2 + 200*OTS*(-1775168 + 
             303117*Pi^2)) - 2*e^6*(127340800*eta^4 - 
           6912000*(769 + 471*OTS) + 1600*eta^3*(-670657 + 662256*OTS) + 
           54*eta*(175389184 + 103833600*OTS - 5352975*Pi^2) + 
           9*eta^2*(883302512 - 592243200*OTS + 13547925*Pi^2)) + 
         3*e^8*(-2106432000 + 85116800*eta^4 + 78400*eta^3*
            (-401 + 3456*OTS) + 270*eta*(-1298528 + 1254400*OTS + 
             63745*Pi^2) + 3*eta^2*(902451968 - 270950400*OTS + 
             47652075*Pi^2)) - 12*e^2*(2550400*eta^4 - 
           1600*eta^3*(232213 + 1944*OTS) + 43200*(115407 + 81046*OTS) + 
           3*eta*(-4449666528 - 3418526720*OTS + 71066925*Pi^2 + 
             80792025*OTS*Pi^2) - 6*eta^2*(-1371516028 + 22625325*Pi^2 + 
             400*OTS*(-1774184 + 41451*Pi^2))) + 
         3*e^4*(20691200*eta^4 - 86400*(-97813 + 46640*OTS) + 
           1600*eta^3*(3109 + 1606608*OTS) + 6*eta^2*(-2040934912 + 
             78854325*Pi^2 + 14400*OTS*(-225964 + 1927*Pi^2)) - 
           225*eta*(-52902272 + 4680753*Pi^2 + 16*OTS*(-5599264 + 108675*
                Pi^2))))*Cos[u] + 3*e^2*(11404800*e^12*eta^3 - 
         72*e^10*eta*(-6417312 - 2077600*eta^2 + 265600*eta^3 + 162450*Pi^2 + 
           25*eta*(104624 + 11673*Pi^2)) + e^8*(-1639180800 + 
           33584000*eta^4 + 1600*eta^3*(-187325 + 176256*OTS) + 
           18*eta*(39010016 + 19584000*OTS - 1894725*Pi^2) + 
           eta^2*(2878531008 - 846028800*OTS + 32242725*Pi^2)) + 
         e^6*(-11353600*eta^4 + 6912000*(339 + 976*OTS) - 
           3200*eta^3*(-498329 + 197856*OTS) - 54*eta*(123451488 + 
             161523200*OTS - 5891175*Pi^2) + 3*eta^2*(-3289713824 + 
             1820160000*OTS + 85653225*Pi^2)) - 
         45*e^4*(2041600*eta^4 - 5760*eta^3*(5657 + 22760*OTS) + 
           5760*(-74809 + 62360*OTS) + 3*eta*(-221992128 - 468221440*OTS + 
             18117195*Pi^2 + 8032200*OTS*Pi^2) + eta^2*(830137792 - 
             20843475*Pi^2 - 640*OTS*(-1749748 + 15375*Pi^2))) + 
         2*(-577600*eta^4 - 172800*(2701 + 27134*OTS) + 
           800*eta^3*(4571 + 146880*OTS) - 3*eta^2*(3934570592 - 
             137208825*Pi^2 + 4800*OTS*(-125152 + 9471*Pi^2)) + 
           18*eta*(490672544 - 27932775*Pi^2 + 20*OTS*(13203776 + 747975*
                Pi^2))) + e^2*(17344000*eta^4 + 3200*eta^3*
            (1205101 + 193104*OTS) - 172800*(263153 + 222990*OTS) + 
           15*eta^2*(-6726857632 + 121785705*Pi^2 + 46080*OTS*
              (-66493 + 1476*Pi^2)) - 18*eta*(-8839062496 + 184134825*Pi^2 + 
             50*OTS*(-114003968 + 2716863*Pi^2))))*Cos[u]^2 + 
       e^3*(28800*e^10*eta*(-2700 + 18453*eta - 12952*eta^2 + 1112*eta^3) + 
         72*e^6*(1936000*eta^4 + 1200*eta^3*(-48361 + 1696*OTS) - 
           57600*(2419 + 6420*OTS) + 6*eta*(16696344 + 70412800*OTS - 
             1233675*Pi^2) - 15*eta^2*(-29201428 + 12614400*OTS + 
             983225*Pi^2)) + e^8*(-130291200 - 71187200*eta^4 - 
           6400*eta^3*(-46445 + 49248*OTS) + 162*eta*(11626784 - 
             2432000*OTS + 438825*Pi^2) + 45*eta^2*(-170931136 + 
             21012480*OTS + 1995195*Pi^2)) - 
         3*(7840000*eta^4 - 345600*(24073 + 36910*OTS) + 
           6400*eta^3*(-38755 + 98784*OTS) - 15*eta^2*(2646533696 - 
             98591385*Pi^2 + 1920*OTS*(256208 + 3075*Pi^2)) + 
           6*eta*(3524453984 - 188243925*Pi^2 + 200*OTS*(28538048 + 39405*
                Pi^2))) + 3*e^4*(90150400*eta^4 + 
           86400*(-140757 + 300160*OTS) - 12800*eta^3*(336797 + 622890*OTS) - 
           120*eta^2*(-541474392 + 11582115*Pi^2 + 160*OTS*(-3703334 + 32595*
                Pi^2)) + 9*eta*(-6836878336 + 363051825*Pi^2 + 
             800*OTS*(-13802768 + 220485*Pi^2))) + 
         2*e^2*(7859200*eta^4 + 1296000*(59123 + 76078*OTS) - 
           1600*eta^3*(5464441 + 1881792*OTS) - 45*eta^2*(-5631391408 + 
             107807295*Pi^2 + 2240*OTS*(-1080848 + 21525*Pi^2)) + 
           18*eta*(768*(-27747154 + 713925*Pi^2) + 25*OTS*(-515444224 + 
               11482545*Pi^2))))*Cos[u]^3 + 
       e^4*(-19692800*eta^4 + 115200*e^10*eta*(9 - 174*eta - 20*eta^2 + 
           16*eta^3) - 1036800*(35633 + 26090*OTS) + 
         30400*eta^3*(-40129 + 62208*OTS) + 9*eta^2*(-13266292736 + 
           507289725*Pi^2 + 140800*OTS*(-42964 + 615*Pi^2)) + 
         6*e^8*(214272000 + 6121600*eta^4 + 800*eta^3*(21055 + 3456*OTS) + 
           54*eta*(-5850592 + 64000*OTS + 33175*Pi^2) - 
           3*eta^2*(-113723392 + 2764800*OTS + 471375*Pi^2)) - 
         18*eta*(-1451510624 + 88669725*Pi^2 + 200*OTS*(-38075072 + 
             610125*Pi^2)) + e^6*(-196019200*eta^4 + 
           1382400*(14261 + 11190*OTS) + 3200*eta^3*(939653 + 255312*OTS) - 
           54*eta*(191041312 + 315609600*OTS - 2608425*Pi^2) + 
           27*eta^2*(-557399072 + 219264000*OTS + 20744175*Pi^2)) - 
         3*e^4*(91328000*eta^4 + 604800*(9313 + 35320*OTS) - 
           3200*eta^3*(1637317 + 2014200*OTS) + eta^2*(67752677568 - 
             1146359025*Pi^2 - 115200*OTS*(-496511 + 4305*Pi^2)) + 
           9*eta*(-8910721216 + 306196275*Pi^2 + 200*OTS*(-47409088 + 720495*
                Pi^2))) + 9*e^2*(9804800*eta^4 + 3200*eta^3*
            (566851 + 345312*OTS) - 57600*(190427 + 406970*OTS) + 
           eta^2*(-56616627296 + 1191626325*Pi^2 + 51200*OTS*(-478519 + 7995*
                Pi^2)) + eta*(83518302528 - 2528419950*Pi^2 - 
             100*OTS*(-509661184 + 9853095*Pi^2))))*Cos[u]^4 - 
       3*e^5*(-25884800*eta^4 + 3200*e^8*(28512 + 27180*eta + 28722*eta^2 - 
           28465*eta^3 + 1759*eta^4) - 345600*(22375 + 10106*OTS) + 
         3200*eta^3*(-60101 + 83808*OTS) + 6*eta^2*(-3889971584 + 
           150594975*Pi^2 + 19200*OTS*(-139184 + 3075*Pi^2)) - 
         36*eta*(164930848 - 2851275*Pi^2 + 20*OTS*(-42849344 + 
             1200615*Pi^2)) + 2*e^6*(-8748800*eta^4 + 
           691200*(3363 + 650*OTS) + 1600*eta^3*(174179 + 67824*OTS) - 
           54*eta*(27726848 + 9779200*OTS - 230175*Pi^2) + 
           eta^2*(-757730928 + 83289600*OTS + 34981875*Pi^2)) - 
         9*e^4*(13536000*eta^4 + 2908800*(319 + 400*OTS) - 
           6400*eta^3*(64891 + 51228*OTS) + 3*eta*(-2028569344 + 
             51026325*Pi^2 + 400*OTS*(-3683360 + 51969*Pi^2)) - 
           4*eta^2*(800*OTS*(-874924 + 7257*Pi^2) + 3*(-371780336 + 4013425*
                Pi^2))) + 4*e^2*(21750400*eta^4 - 
           43200*(86621 + 256146*OTS) + 800*eta^3*(866929 + 926640*OTS) + 
           24*eta^2*(-1084685053 + 25512525*Pi^2 + 2700*OTS*(-181592 + 2419*
                Pi^2)) - 9*eta*(-4314105056 + 145647225*Pi^2 + 
             5*OTS*(-540971008 + 8695965*Pi^2))))*Cos[u]^5 + 
       e^6*(-1600*e^8*(-13824 - 17928*eta - 15408*eta^2 + 17677*eta^3 + 
           7814*eta^4) + 3*e^6*(11737600*eta^4 - 2764800*(-337 + 50*OTS) + 
           3200*eta^3*(7855 + 21312*OTS) - 3*eta^2*(93844192 + 44697600*OTS - 
             3872475*Pi^2) + 18*eta*(-21732448 + 6771200*OTS + 
             239775*Pi^2)) - 3*e^4*(64889600*eta^4 + 
           86400*(25431 + 42680*OTS) - 3200*eta^3*(502399 + 222264*OTS) + 
           eta^2*(12667202496 - 49233375*Pi^2 - 9600*OTS*(-556628 + 3813*
                Pi^2)) + 45*eta*(-398502976 + 7452735*Pi^2 + 
             40*OTS*(-5108416 + 55905*Pi^2))) - 
         3*(13136000*eta^4 + 691200*(2978 + 1325*OTS) - 
           11200*eta^3*(-145 + 4032*OTS) - 3*eta^2*(-2451286528 + 
             96825525*Pi^2 + 9600*OTS*(-234560 + 6273*Pi^2)) + 
           6*eta*(1155296288 - 33866475*Pi^2 + 200*OTS*(-8796352 + 346413*
                Pi^2))) + e^2*(138790400*eta^4 - 3628800*(4509 + 11878*OTS) + 
           3200*eta^3*(600179 + 1227312*OTS) + 9*eta^2*(-12018032352 + 
             311355975*Pi^2 + 25600*OTS*(-223241 + 2337*Pi^2)) - 
           18*eta*(-9409801056 + 339440625*Pi^2 + 10*OTS*(-596291584 + 
               8011155*Pi^2))))*Cos[u]^6 + 
       e^7*(800*e^6*(138240 - 22788*eta + 94617*eta^2 - 10276*eta^3 + 
           14080*eta^4) - 3*e^4*(1971200*eta^4 + 128000*eta^3*
            (1838 + 675*OTS) - 432000*(37 + 1888*OTS) + 
           9*eta*(273500288 + 91072000*OTS - 2901975*Pi^2) - 
           6*eta^2*(272987488 + 67027200*OTS + 1266375*Pi^2)) - 
         80*(25600*eta^4 + 1280*eta^3*(55 + 162*OTS) - 
           25920*(235 + 277*OTS) + 360*eta^2*(-98776 - 119728*OTS + 
             4059*Pi^2 + 3567*OTS*Pi^2) - 9*eta*(7487456 - 6097088*OTS - 
             238200*Pi^2 + 314925*OTS*Pi^2)) + 6*e^2*(1177600*eta^4 + 
           432000*(1201 + 1994*OTS) - 1600*eta^3*(26017 + 66528*OTS) + 
           150*eta*(72*(-412592 + 15753*Pi^2) + OTS*(-18890240 + 222819*
                Pi^2)) - 3*eta^2*(1600*OTS*(-275552 + 2337*Pi^2) + 
             27*(-33570224 + 939875*Pi^2))))*Cos[u]^7))/
     (16588800*OTS^7*(-1 + e*Cos[u])^9)   ;
        
    Return[var];
    
    
];


Wph = 
  Module[{var, OTS},


  OTS = (1-e^2)^(1/2);
  
  var=    -2*ArcTan[((-1 + OTS)*Sin[u])/(e + (-1 + OTS)*Cos[u])] + e*Sin[u] + 
    (x*(ArcTan[((-1 + OTS)*Sin[u])/(e + (-1 + OTS)*Cos[u])]*
        (6 - 6*e*Cos[u]) + e*(-3 + (-4 + eta)*OTS + 3*e*Cos[u])*Sin[u]))/
     (OTS^2*(-1 + e*Cos[u])) + 
    (x^2*(-48*(54 + e^2*(51 - 26*eta) - 28*eta + 6*(-5 + 2*eta)*OTS^3)*
        ArcTan[((-1 + OTS)*Sin[u])/(e + (-1 + OTS)*Cos[u])] + 
       (e*(-24*e*(-32 + 15*eta + eta^2)*OTS*(e - Cos[u])*(-1 + e*Cos[u]) + 
          OTS*(e^2*(384 - 112*eta + 55*eta^2) + 4*(588 - 296*eta - eta^2 - 
              36*(-5 + 2*eta)*OTS + 3*eta*(4 + eta)*OTS^3))*
           (-1 + e*Cos[u])^2 + 24*(-54 + 28*eta + e^2*(-51 + 26*eta))*
           (-1 + e*Cos[u])^3 + 9*e^2*eta^2*OTS*(1 - 4*e^2 + 6*e*Cos[u] + 
            (-4 + e^2)*Cos[u]^2))*Sin[u])/(1 - e*Cos[u])^3))/(96*OTS^4) + 
    (x^3*(-4*(48*e^4*(156 - 110*eta + 65*eta^2) - 384*eta^2*(-7 + 5*OTS^3) - 
         2880*(-7 - 2*OTS + 5*OTS^3) - 3*e^2*(-18144 + 26112*eta - 
           5120*eta^2 + 768*(-5 + 2*eta)*OTS + 64*(30 - 29*eta + 11*eta^2)*
            OTS^3 - 123*eta*Pi^2) - 2*eta*(30000 + 1152*OTS - 738*Pi^2 + 
           OTS^3*(-12608 + 123*Pi^2)))*ArcTan[((-1 + OTS)*Sin[u])/
          (e + (-1 + OTS)*Cos[u])] + 
       (e*(2*e*OTS*(29184 - 26720*eta + 2832*eta^2 + 304*eta^3 + 
            4*e^2*(1536 - 823*eta + 156*eta^2 + 104*eta^3) + 
            576*(20 - 13*eta + 2*eta^2)*OTS - 24*eta*(-9 + 12*eta + 8*eta^2)*
             OTS^3 + 147*eta*Pi^2)*(-e + Cos[u])*(1 - e*Cos[u])^3 + 
          6*(896*eta^2 + 16*e^4*(156 - 110*eta + 65*eta^2) + 
            960*(7 + 2*OTS) - 4*eta*(5000 + 192*OTS - 123*Pi^2) + 
            e^2*(5120*eta^2 + 96*(189 + 40*OTS) - 3*eta*(8704 + 512*OTS - 
                41*Pi^2)))*(1 - e*Cos[u])^5 + 
          OTS*(-2*e^4*eta*(-624 + 71*eta^2) + e^2*(79872 - 84100*eta + 
              19880*eta^2 + 124*eta^3 + 384*(50 - 42*eta + 13*eta^2)*OTS - 
              4*eta*(48 + 32*eta + 65*eta^2)*OTS^3 + 3*eta*Pi^2) - 
            4*(-8*eta^3*OTS^3 + 96*(-285 - 175*OTS + 78*OTS^3) + 
              8*eta^2*(-419 - 240*OTS + 155*OTS^3) + eta*(44204 - 753*Pi^2 + 
                OTS*(18848 - 123*Pi^2) + OTS^3*(-7940 + 3*Pi^2))))*
           (-1 + e*Cos[u])^4 - OTS*(4096 - 600*eta^2 + 
            eta^3*(428 + 129*e^2 - 52*OTS^3) + eta*(-2468 + 3*Pi^2))*
           (e - e^2*Cos[u])^2*(1 - 4*e^2 + 6*e*Cos[u] + (-4 + e^2)*
             Cos[u]^2) - 24*e^3*eta*(5 - 44*eta + 28*eta^2)*OTS*
           (1 - e*Cos[u])*(e*(-1 + 2*e^2) + Cos[u] - 4*e^2*Cos[u] - 
            e*(-4 + e^2)*Cos[u]^2 + (-2 + e^2)*Cos[u]^3) + 
          15*e^4*eta^3*OTS*(1 - 12*e^2 + 16*e^4 + 20*e*(1 - 2*e^2)*Cos[u] - 
            6*(2 - 9*e^2 + 2*e^4)*Cos[u]^2 + 20*e*(-2 + e^2)*Cos[u]^3 + 
            (16 - 12*e^2 + e^4)*Cos[u]^4))*Sin[u])/(1 - e*Cos[u])^5))/
     (768*OTS^6) + 
    (x^3*(-960*(11520*(1 - e^2)*(15840 + 3648*eta^2 + 
           24*e^4*(495 - 464*eta + 140*eta^2) + eta*(-22784 + 123*Pi^2) + 
           2*e^2*(32580 + 7296*eta^2 + eta*(-38096 + 123*Pi^2))) - 
         5*OTS*(256*e^6*(-7560 + 1917*eta - 4725*eta^2 + 6422*eta^3) + 
           3*e^4*(-36422784 + 8018944*eta^3 + eta*(80260608 - 656649*Pi^2) + 
             864*eta^2*(-57616 + 369*Pi^2)) + 12*e^2*(-17224704 + 
             1707008*eta^3 + eta*(63434112 - 1487853*Pi^2) + 
             1152*eta^2*(-30082 + 615*Pi^2)) + 8*(-5235840 + 100352*eta^3 + 
             eta*(16576896 - 396639*Pi^2) + 288*eta^2*(-43240 + 1353*
                Pi^2))) + 12*OTS^3*(-69120*(5 - 2*eta)^2 + 
           1920*e^4*(72*(5 - 2*eta)^2 + (-360 + 111*eta - 403*eta^2 + 286*
                eta^3)*OTS) + 4*OTS*(-4829760 + 76800*eta^3 + 
             eta*(13987648 - 378885*Pi^2) + 720*eta^2*(-8616 + 205*Pi^2)) + 
           5*e^2*(-13824*(5 - 2*eta)^2 + OTS*(-4648320 + 568320*eta^3 + eta*
                (12510976 - 159843*Pi^2) + 96*eta^2*(-70688 + 615*Pi^2)))))*x*
        ArcTan[((-1 + OTS)*Sin[u])/(e + (-1 + OTS)*Cos[u])] + 
       (e*(144*e*OTS*(19200*(-1 + e^2)*(-85200 + 456*eta^3 + 6*e^2*(-4160 + 
                4112*eta - 1685*eta^2 + 242*eta^3) + eta*(111632 - 
                492*Pi^2) + eta^2*(-27764 + 123*Pi^2)) - 
            OTS*(100*e^4*(-294912 - 7716*eta - 191501*eta^2 + 35958*eta^3 + 
                62170*eta^4) + e^2*(-1282464000 + 106804800*eta^3 + 
                10480000*eta^4 + eta*(2513784128 - 22402050*Pi^2) - 
                3*eta^2*(446345696 + 1220625*Pi^2)) + 4*(-562406400 + 
                27780000*eta^3 + 76000*eta^4 - 96*eta*(-15260996 + 
                  292125*Pi^2) + eta^2*(-695201008 + 10252725*Pi^2))))*x*
           (-e + Cos[u])*(1 - e*Cos[u])^5 + 
          2*OTS*(2880*(-1 + e^2)*(480*e^4*(-3360 + 3788*eta - 3449*eta^2 + 
                1386*eta^3) + 5*e^2*(-14348160 + 908352*eta^3 + 
                eta*(22514816 - 175587*Pi^2) + 32*eta^2*(-313805 + 
                  1968*Pi^2)) + 4*(-17012160 + 262080*eta^3 + 
                eta*(32191808 - 477285*Pi^2) + 40*eta^2*(-277996 + 
                  4305*Pi^2))) - OTS*(200*e^6*(1769472 + 2294784*eta + 
                852480*eta^2 + 8665*eta^3 + 14414*eta^4) + 
              3*e^4*(-11147673600 + 3339222400*eta^3 + 42752000*eta^4 - 
                450*eta*(-40356320 + 19857*Pi^2) - 3*eta^2*(5349121792 + 
                  2526525*Pi^2)) + 16*(-14243558400 + 380024800*eta^3 - 
                11200*eta^4 + eta*(41318881344 - 938426850*Pi^2) + 
                135*eta^2*(-137051392 + 2984955*Pi^2)) + 
              6*e^2*(-52235366400 + 4885408000*eta^3 + 416000*eta^4 - 
                18*eta*(-8321965792 + 147576525*Pi^2) + eta^2*(-77926460928 + 
                  909652725*Pi^2))))*x*(-1 + e*Cos[u])^6 - 
          3*e^2*OTS*(8294400*(-1 + e^2)*(-5 + 2*eta)*(128 - 60*eta + 
              (-17 + e^2)*eta^2) - OTS*(3600*e^4*eta^2*(-4608 + 12627*eta + 
                8282*eta^2) + 3*e^2*(-943718400 - 67939200*eta^3 + 
                91008000*eta^4 + eta*(1085173824 - 6058350*Pi^2) + 
                5*eta^2*(-137487872 + 33075*Pi^2)) + 4*(-3107635200 + 
                165312000*eta^3 + 23212800*eta^4 + eta*(6412412608 - 
                  86200050*Pi^2) + eta^2*(-4648041984 + 79716825*Pi^2))))*x*
           (-1 + e*Cos[u])^4*(1 - 4*e^2 + 6*e*Cos[u] + (-4 + e^2)*Cos[u]^2) + 
          144*e^3*OTS*(3110400*(-1 + e^2)*eta^2*(-5 + 2*eta)*x - 
            OTS*(117964800 + 14400*(589 + 354*e^2)*eta^3 - 100800*(98 + 
                71*e^2)*eta^4 + 15*eta^2*(21958688 + 135360*e^2 - 
                609905*Pi^2) - 4*eta*(58860656 + 720000*e^2 - 528225*Pi^2))*
             x)*(1 - e*Cos[u])^3*(e*(-1 + 2*e^2) + Cos[u] - 4*e^2*Cos[u] - 
            e*(-4 + e^2)*Cos[u]^2 + (-2 + e^2)*Cos[u]^3) - 
          81*e^4*eta*(16*(389116 - 1279104*eta + 25*(-5384 + 325*e^2)*eta^2 + 
              350*(352 + 45*e^2)*eta^3) + 225*(-50 + 2577*eta)*Pi^2)*x*
           (OTS - e*OTS*Cos[u])^2*(1 - 12*e^2 + 16*e^4 + 20*e*(1 - 2*e^2)*
             Cos[u] - 6*(2 - 9*e^2 + 2*e^4)*Cos[u]^2 + 20*e*(-2 + e^2)*
             Cos[u]^3 + (16 - 12*e^2 + e^4)*Cos[u]^4) + 
          43200*e^5*eta*(1476 - 5755*eta - 646*eta^2 + 1350*eta^3)*OTS^2*x*
           (1 - e*Cos[u])*(e*(3 - 16*e^2 + 16*e^4) + (-3 + 36*e^2 - 48*e^4)*
             Cos[u] - 2*e*(18 - 41*e^2 + 8*e^4)*Cos[u]^2 + 
            2*(8 - 41*e^2 + 18*e^4)*Cos[u]^3 + 3*e*(16 - 12*e^2 + e^4)*
             Cos[u]^4 + (-16 + 16*e^2 - 3*e^4)*Cos[u]^5) + 
          1134000*e^6*eta^3*(-1 + 2*eta)*OTS^2*x*(1 - 24*e^2 + 80*e^4 - 
            64*e^6 + 14*e*(3 - 16*e^2 + 16*e^4)*Cos[u] + 
            (-24 + 303*e^2 - 464*e^4 + 80*e^6)*Cos[u]^2 - 
            28*e*(8 - 21*e^2 + 8*e^4)*Cos[u]^3 + (80 - 464*e^2 + 303*e^4 - 
              24*e^6)*Cos[u]^4 + 14*e*(16 - 16*e^2 + 3*e^4)*Cos[u]^5 + 
            (-64 + 80*e^2 - 24*e^4 + e^6)*Cos[u]^6) + 12*x*(-1 + e*Cos[u])^2*
           (-200*(256*e^6*(6422*eta^3*OTS - 945*eta^2*(-32 + 5*OTS) - 
                1080*(-99 + 7*OTS) + 27*eta*(-3712 + 71*OTS)) + 
              3*e^4*(1536*(26640 + 5616*eta^2 + eta*(-32528 + 123*Pi^2)) + 
                OTS*(-36422784 + 8018944*eta^3 + eta*(80260608 - 656649*
                     Pi^2) + 864*eta^2*(-57616 + 369*Pi^2))) + 
              12*e^2*(1707008*eta^3*OTS - 13824*(685 + 1246*OTS) - 
                3*eta*(-3418112 - 21144704*OTS + 7872*Pi^2 + 495951*OTS*
                   Pi^2) + 1152*eta^2*(-1824 + OTS*(-30082 + 615*Pi^2))) + 
              8*(100352*eta^3*OTS - 51840*(88 + 101*OTS) + eta*(6561792 - 
                  35424*Pi^2 + OTS*(16576896 - 396639*Pi^2)) + 288*eta^2*
                 (-3648 + OTS*(-43240 + 1353*Pi^2))))*(1 - e*Cos[u])^5 - 
            1382400*eta*(4 + eta)*(-54 + 28*eta + e^2*(-51 + 26*eta))*OTS^5*
             (-1 + e*Cos[u])^4 + 3*(800*e^4*eta*(-1152*(-20 + OTS) + 
                6286*eta^3*OTS + 384*eta*(-9 + 4*OTS) + eta^2*(-2304 + 
                  18337*OTS)) + 32*(-115200*(225 - 200*eta + 39*eta^2 + 
                  2*eta^3) + OTS*(-99475200 + 8105800*eta^3 + 2800*eta^4 + 
                  eta*(351112672 - 8752800*Pi^2) + 15*eta^2*(-11651168 + 
                    205725*Pi^2))) + e^2*(921600*(900 - 820*eta + 159*eta^2 + 
                  10*eta^3) + OTS*(-1725235200 + 296552000*eta^3 + 
                  80000*eta^4 - 150*eta*(-18978272 + 22161*Pi^2) - 
                  eta^2*(1667201792 + 2123325*Pi^2))))*(OTS - e*OTS*Cos[u])^
              4 + 691200*OTS^5*(-1 + e*Cos[u])^2*(-12*e*eta*(-9 + 12*eta + 
                8*eta^2)*(e - Cos[u])*(-1 + e*Cos[u]) - (7488 + 32*(41 + e^2)*
                 eta^2 + (-8 + 65*e^2)*eta^3 + eta*(-7652 + 48*e^2 + 3*Pi^2))*
               (-1 + e*Cos[u])^2 + 13*e^2*eta^3*(1 - 4*e^2 + 6*e*Cos[u] + 
                (-4 + e^2)*Cos[u]^2)) + 3*e*OTS^4*
             (32*(86400*eta*(-20 + 3*eta + 2*eta^2)*OTS^2 - 
                OTS*(-46094400 + 1200*(5040 + 913*e^2)*eta^3 + 
                  1800*(2 + 257*e^2)*eta^4 + eta*(85176256 - 1134000*e^2 - 
                    1101225*Pi^2) + eta^2*(-70060432 + 4407300*e^2 + 
                    3159975*Pi^2)))*(e - Cos[u])*(1 - e*Cos[u])^3 - 
              e*eta*OTS*(16*(-4401372 - 7976560*eta + 75*(14972 + 603*e^2)*
                   eta^2 + 150*(1532 + 685*e^2)*eta^3) + 225*(10802 + 
                  59407*eta)*Pi^2)*(-1 + e*Cos[u])^2*(1 - 4*e^2 + 
                6*e*Cos[u] + (-4 + e^2)*Cos[u]^2) + 9600*e^2*eta*(516 - 
                3303*eta - 52*eta^2 + 774*eta^3)*OTS*(1 - e*Cos[u])*(e - 
                2*e^3 + (-1 + 4*e^2)*Cos[u] + e*(-4 + e^2)*Cos[u]^2 - 
                (-2 + e^2)*Cos[u]^3) + 3600*e^3*eta^3*(-25 + 66*eta)*OTS*(1 - 
                12*e^2 + 16*e^4 + 20*e*(1 - 2*e^2)*Cos[u] - 
                6*(2 - 9*e^2 + 2*e^4)*Cos[u]^2 + 20*e*(-2 + e^2)*Cos[u]^3 + 
                (16 - 12*e^2 + e^4)*Cos[u]^4))))*Sin[u])/(1 - e*Cos[u])^7))/
     (530841600*OTS^9)  ;
  
    Return[var];
    
    
];


\[Lambda]ph = 
  Module[{var1,var, OTS},


  OTS = (1-e^2)^(1/2);
  
  var1= (3*x)/OTS^2 - ((-54 + 28*eta + e^2*(-51 + 26*eta))*x^2)/(4*OTS^4) + 
    ((896*eta^2 + 16*e^4*(156 - 110*eta + 65*eta^2) + 960*(7 + 2*OTS) - 
       4*eta*(5000 + 192*OTS - 123*Pi^2) + 
       e^2*(5120*eta^2 + 96*(189 + 40*OTS) - 3*eta*(8704 + 512*OTS - 
           41*Pi^2)))*x^3)/(128*OTS^6) - 
    ((256*e^6*(6422*eta^3*OTS - 945*eta^2*(-32 + 5*OTS) - 
         1080*(-99 + 7*OTS) + 27*eta*(-3712 + 71*OTS)) + 
       3*e^4*(3456*(11840 - 10539*OTS) + 8018944*eta^3*OTS + 
         eta*(-49963008 + 80260608*OTS + 188928*Pi^2 - 656649*OTS*Pi^2) + 
         864*eta^2*(9984 - 57616*OTS + 369*OTS*Pi^2)) + 
       8*(100352*eta^3*OTS - 51840*(88 + 101*OTS) + 
         eta*(6561792 + 16576896*OTS - 35424*Pi^2 - 396639*OTS*Pi^2) + 
         288*eta^2*(-3648 - 43240*OTS + 1353*OTS*Pi^2)) + 
       12*e^2*(1707008*eta^3*OTS - 13824*(685 + 1246*OTS) + 
         1152*eta^2*(-1824 - 30082*OTS + 615*OTS*Pi^2) - 
         3*eta*(-3418112 - 21144704*OTS + 7872*Pi^2 + 495951*OTS*Pi^2)))*x^4)/
     (221184*OTS^9) ;
     
  var=  (1+var1) l;  
    
          Return[var];
  
];


(*betaphIneph = 
  Module[{var, OTS},


  OTS = (1-e^2)^(1/2);
  var=   (1 - OTS)/e + ((-4 + eta)*(-1 + OTS)*x)/(e*OTS) - ((-4*(264 - 40*eta + 25*eta^2)*(-1 + OTS) + e^2*(-112*eta*(-7 + OTS) + 48*(-39 + 8*OTS) + eta^2*(-103 + 55*OTS)))*x^2)/(96*e*OTS^3) + 
 ((2*e^4*(15744 + 3824*eta^2 - 16*eta*(673 + 39*OTS) + eta^3*(-291 + 71*OTS)) - 8*(-1 + OTS)*(960 + 24*eta^2 - 104*eta^3 + eta*(-5654 + 315*Pi^2)) + 
    e^2*(768*(-9 + 62*OTS) + 32*eta^2*(163 + 81*OTS) - 4*eta^3*(-475 + 371*OTS) - 3*eta*(23660 + 788*OTS + (-165 + OTS)*Pi^2)))*x^3)/(768*e*OTS^5) - 
 ((-200*e^6*(221184*(145 + 8*OTS) + 27648*eta*(-942 + 83*OTS) + 2304*eta^2*(10753 + 370*OTS) + 2*eta^4*(224381 + 7207*OTS) + eta^3*(-11457241 + 8665*OTS)) - 
    16*(-1 + OTS)*(-261273600 + 102623200*eta^3 + 18680000*eta^4 + 45*eta^2*(-107067136 + 2363505*Pi^2) + 18*eta*(-294879712 + 14390175*Pi^2)) - 
    3*e^4*(16588800*(593 + 1144*OTS) - 3200*eta^3*(1209023 + 69889*OTS) + 3200*eta^4*(-118027 + 75319*OTS) - 3*eta^2*(256*(-61306507 + 2468507*OTS) + 75*(1311337 + 33687*OTS)*Pi^2) - 
      150*eta*(543534496 + 52929120*OTS + (-5687571 + 59571*OTS)*Pi^2)) + 6*e^2*(-5529600*(918 + 1855*OTS) - 44800*eta^3*(-17407 + 6847*OTS) + 6400*eta^4*(-24643 + 20749*OTS) - 
      3*eta^2*(512*(30088573 - 16124173*OTS) + 75*(-5206933 + 3092373*OTS)*Pi^2) + 6*eta*(32*(372247573 - 91705493*OTS) + 75*(-7545605 + 4407877*OTS)*Pi^2)))*x^4)/(265420800*e*OTS^7)  ;
      
    Return[var];
    
    
];*)


xDotInxe = 
  Module[{var, var1,var2,\[Phi],\[Phi]t,\[Psi],\[Zeta],\[Kappa],F,\[Psi]\[Omega],\[Zeta]\[Omega]},
  
  var1 =     (2*eta*x^5*((96/5 + (292*e^2)/5 + (37*e^4)/5)/(1 - e^2)^(7/2) + ((-1486/35 + e^2*(2193/7 - 570*eta) + e^4*(12217/20 - (5061*eta)/10) + e^6*(11717/280 - (148*eta)/5) - (264*eta)/5)*x)/(1 - e^2)^(9/2) + 
   ((-11257/945 + Sqrt[1 - e^2]*(48 + e^4*(2193 - (4386*eta)/5) + e^2*(2134 - (4268*eta)/5) + e^6*(175/2 - 35*eta) - (96*eta)/5) + (15677*eta)/105 + (944*eta^2)/15 + 
      e^8*(391457/3360 - (6037*eta)/56 + (2923*eta^2)/45) + e^2*(-2960801/945 - (2781*eta)/5 + (182387*eta^2)/90) + e^6*(925073/336 - (199939*eta)/48 + (192943*eta^2)/90) + 
      e^4*(-68647/1260 - (1150631*eta)/140 + (396443*eta^2)/72))*x^2)/(1 - e^2)^(11/2) + 
   (x^3*(614389219/148500 - (16073*eta^2)/140 - (1121*eta^3)/27 + e^10*(33332681/197120 - (1874543*eta)/10080 + (109733*eta^2)/840 - (8288*eta^3)/81) + eta*(-57265081/11340 + (369*Pi^2)/2) + 
      e^6*(-4548320963/5544000 + (411401857*eta^2)/6720 - (3200965*eta^3)/108 + eta*(-59823689/4032 - (242563*Pi^2)/640)) + 
      e^4*(-3983966927/8316000 + (34877019*eta^2)/1120 - (33769597*eta^3)/1296 + eta*(6451690597/90720 - (12403*Pi^2)/64)) + 
      e^8*(19593451667/2464000 + (92762*eta^2)/7 - (982645*eta^3)/162 + eta*(-6614711/480 - (12177*Pi^2)/640)) + e^2*(19769277811/693000 - (3161701*eta^2)/840 - (1287385*eta^3)/324 + 
        eta*(66358561/3240 + (42571*Pi^2)/80)) + Sqrt[1 - e^2]*(-1425319/1125 + (632*eta^2)/5 + e^8*(56403/112 - (427733*eta)/840 + (4739*eta^2)/30) + eta*(9874/105 - (41*Pi^2)/10) + 
        e^6*(702667207/31500 + (232177*eta^2)/30 + eta*(-6830419/252 + (287*Pi^2)/960)) + e^2*(933454/375 + (125278*eta^2)/15 + eta*(-2257181/63 + (45961*Pi^2)/240)) + 
        e^4*(840635951/21000 + (317273*eta^2)/15 + eta*(-4927789/60 + (6191*Pi^2)/32))) + (54784/175 + (465664*e^2)/105 + (4426376*e^4)/525 + (1498856*e^6)/525 + (31779*e^8)/350)*
       Log[((1 + Sqrt[1 - e^2])*x)/(2*(1 - e^2)*x00)]))/(1 - e^2)^(13/2)))/3    ;
      
      
      \[Phi] =(1. + 7.161465118700464*e^2 + 5.123750607415342*e^4 + 0.27152365629214764*e^6 + 0.0026638312318956084*e^8 - 0.0006503698354545273*e^10 + 0.00005348190424710328*e^12 + 4.995198771366267*^-6*e^14)/
 (1. - 4.99999321463287*e^2 + 9.999970170789036*e^4 - 9.999950337563803*e^6 + 4.999962801929392*e^8 - 0.9999893895821987*e^10)  ;                 (*This is Subscript[\[Phi], e]*)
 
  
      \[Phi]t=(1. + 1.9772130143629045*e^2 - 2.532520458856221*e^4 + 0.42945527166451236*e^6 + 0.07172584674296154*e^8 - 0.005290326881160598*e^10 - 0.0001609228123359163*e^12)/
 (1. - 4.5540369856370955*e^2 + 8.343846103586062*e^4 - 7.790198982293166*e^6 + 3.845684157972635*e^8 - 0.9257734859048078*e^10 + 0.08046501152984134*e^12);                    (*This is Subscript[\[Phi], e] tilde*)
 
 
      \[Psi] = (1. - 8.806403105992448*e^2 - 37.80500757095231*e^4 - 13.33581172083053*e^6 - 0.3086449422889928*e^8 + 0.001194273326848352*e^10 - 0.0010630723322879111*e^12)/
 (1. - 5.99990817252889*e^2 + 14.99949222210176*e^4 - 19.998864170121077*e^6 + 14.998711679625572*e^8 - 5.999256032426212*e^10 + 0.9998239561805266*e^12) ;                  (*This is Subscript[\[Psi], e]*)  
 
 
      \[Zeta] = (1. + 14.785895861110044*e^2 + 28.980701495962784*e^4 + 11.892967380758984*e^6 + 1.3186736878868608*e^8 + 0.029247319475411523*e^10)/
 (1. - 5.870091233556296*e^2 + 14.22053295419146*e^4 - 18.05128621806095*e^6 + 12.40163369204098*e^8 - 4.05114139969618*e^10 + 0.22040779015507783*e^12 + 0.12994477908286473*e^14);       (*This is Subscript[\[Zeta], e]*) 
 
 
    \[Kappa]=(1.` +19.173226897678433` e^2+51.92987496225937` e^4+28.365025065993706` e^6+2.0823453033521053` e^8-0.07880091740707043` e^10-1.6997970532597475` e^18)/(1.` -6.8128356864837984` e^2+19.832707379417762` e^4-31.95366746247916` e^6+30.73681093644748` e^8-17.61985115971636` e^10+5.556329716595683` e^12-0.7392526374241343` e^14-0.00022010723547250102` e^22)  ;
     
       
       F = (1+(85/6)*e^2+(5171/192)*e^4+(1751/192)*e^6+(297/1024)*e^8)/(1-e^2)^(13/2)       ;                          (*This is F(e)*)     
       
       
       \[Psi]\[Omega] = 1344/4159 1/(1-e^2)^(3/2) ((1-e^2)^(1/2) (1-5 e^2)\[Phi]  - 4 \[Phi]t)  +  8191/4159 \[Psi] ;
       
       \[Zeta]\[Omega] = 583/567 \[Zeta] - 16/567 \[Phi];
          
 var2= (64/5)*x^5*eta*(4*Pi*x^(3/2)*\[Phi] + Pi*x^(5/2)*(-(4159/672)*\[Psi]\[Omega]-(189/8)*eta*\[Zeta]\[Omega] )+x^3*(-(116761/3675)*\[Kappa]+((16/3)*Pi^2-(1712/105)*N[EulerGamma]-(1712/105)*Log[4*x^(3/2)/x00])*F))    ;
 
 var= var1+var2;

    Return[var] ;   
   
];



eDotInxe = 
  Module[{var, var1,var2,\[Phi],\[Phi]t, \[Phi]e,\[Psi],\[Zeta],\[Kappa],Fe,\[Psi]\[Omega],\[Zeta]\[Omega], OTS,\[Psi]t,\[Psi]e, \[Zeta]t, \[Zeta]e,\[Kappa]e,\[Kappa]t},

   OTS = (1-e^2)^(1/2);
      
  var1 =  -(e*eta*x^4*((304/15 + (121*e^2)/15)/(1 - e^2)^(5/2) + ((-939/35 + e^2*(29917/105 - (7753*eta)/30) + e^4*(13929/280 - (1664*eta)/45) - (4084*eta)/45)*x)/(1 - e^2)^(7/2) + 
   ((-961973/1890 + Sqrt[1 - e^2]*(1336/3 + e^2*(2321/2 - (2321*eta)/5) + e^4*(565/6 - (113*eta)/3) - (2672*eta)/15) + (70967*eta)/210 + (752*eta^2)/5 + e^6*(420727/3360 - (362071*eta)/2520 + (821*eta^2)/9) + 
      e^4*(23222071/15120 - (13402843*eta)/5040 + (127411*eta^2)/90) + e^2*(-3180307/2520 - (1541059*eta)/840 + (64433*eta^2)/40))*x^2)/(1 - e^2)^(9/2) + 
   (x^3*(54177075619/6237000 + 730168/(23625*(1 + Sqrt[1 - e^2])) - (3000281*eta^2)/2520 - (61001*eta^3)/486 + e^8*(302322169/1774080 - (1921387*eta)/10080 + (41179*eta^2)/216 - (193396*eta^3)/1215) + 
      eta*(7198067/22680 + (1283*Pi^2)/10) + e^4*(-126288160777/16632000 + (478808759*eta^2)/20160 - (2223241*eta^3)/180 + eta*(418129451/181440 - (254903*Pi^2)/1920)) + 
      e^6*(5845342193/1232000 + (6538757*eta^2)/630 - (11792069*eta^3)/2430 + eta*(-98425673/10080 - (6519*Pi^2)/640)) + 
      e^2*(6346360709/891000 + (12478601*eta^2)/15120 - (86910509*eta^3)/19440 + eta*(9569213/360 + (54001*Pi^2)/960)) + 
      Sqrt[1 - e^2]*(-22713049/15750 + (54332*eta^2)/45 + e^6*(186961/336 - (289691*eta)/504 + (3197*eta^2)/18) + eta*(-5526991/945 + (8323*Pi^2)/180) + 
        e^4*(5321445613/378000 + (225106*eta^2)/45 + eta*(-26478311/1512 + (2501*Pi^2)/2880)) + e^2*(89395687/7875 + (681989*eta^2)/90 + eta*(-38295557/1260 + (94177*Pi^2)/960))) + 
      (304*(82283/1995 + (297674*e^2)/1995 + (1147147*e^4)/15960 + (61311*e^6)/21280)*Log[((1 + Sqrt[1 - e^2])*x)/(2*(1 - e^2)*x00)])/15))/(1 - e^2)^(11/2)))      ;
      



 
      \[Phi] =(1. + 7.161465118700464*e^2 + 5.123750607415342*e^4 + 0.27152365629214764*e^6 + 0.0026638312318956084*e^8 - 0.0006503698354545273*e^10 + 0.00005348190424710328*e^12 + 4.995198771366267*^-6*e^14)/
 (1. - 4.99999321463287*e^2 + 9.999970170789036*e^4 - 9.999950337563803*e^6 + 4.999962801929392*e^8 - 0.9999893895821987*e^10)  ;                 (*This is Subscript[\[Phi], e]*)
 
  
      \[Phi]t=(1. + 1.9772130143629045*e^2 - 2.532520458856221*e^4 + 0.42945527166451236*e^6 + 0.07172584674296154*e^8 - 0.005290326881160598*e^10 - 0.0001609228123359163*e^12)/
 (1. - 4.5540369856370955*e^2 + 8.343846103586062*e^4 - 7.790198982293166*e^6 + 3.845684157972635*e^8 - 0.9257734859048078*e^10 + 0.08046501152984134*e^12);                    (*This is Subscript[\[Phi], e] tilde*)
 
 
      \[Psi] = (1. - 8.806403105992448*e^2 - 37.80500757095231*e^4 - 13.33581172083053*e^6 - 0.3086449422889928*e^8 + 0.001194273326848352*e^10 - 0.0010630723322879111*e^12)/
 (1. - 5.99990817252889*e^2 + 14.99949222210176*e^4 - 19.998864170121077*e^6 + 14.998711679625572*e^8 - 5.999256032426212*e^10 + 0.9998239561805266*e^12) ;                  (*This is Subscript[\[Psi], e]*)  
 
 
      \[Zeta] = (1. + 14.785895861110044*e^2 + 28.980701495962784*e^4 + 11.892967380758984*e^6 + 1.3186736878868608*e^8 + 0.029247319475411523*e^10)/
 (1. - 5.870091233556296*e^2 + 14.22053295419146*e^4 - 18.05128621806095*e^6 + 12.40163369204098*e^8 - 4.05114139969618*e^10 + 0.22040779015507783*e^12 + 0.12994477908286473*e^14);       (*This is Subscript[\[Zeta], e]*) 
 
 
     \[Kappa]=(1.` +19.173226897678433` e^2+51.92987496225937` e^4+28.365025065993706` e^6+2.0823453033521053` e^8-0.07880091740707043` e^10-1.6997970532597475` e^18)/(1.` -6.8128356864837984` e^2+19.832707379417762` e^4-31.95366746247916` e^6+30.73681093644748` e^8-17.61985115971636` e^10+5.556329716595683` e^12-0.7392526374241343` e^14-0.00022010723547250102` e^22)  ;

       
       Fe = (1+(2782/769)*e^2+(10721/6152)*e^4+(1719/24608)*e^6)/(1-e^2)^(11/2)       ;                          (*This is Fe(e)*)     
       
       
       \[Psi]\[Omega] = 1344/4159 1/(1-e^2)^(3/2) ((1-e^2)^(1/2) (1-5 e^2)\[Phi]  - 4 \[Phi]t)  +  8191/4159 \[Psi] ;
       
       \[Zeta]\[Omega] = 583/567 \[Zeta] - 16/567 \[Phi];
       
\[Phi]e = 192/985 (1-e^2)^(1/2)/e^2 ((1-e^2)^(1/2) \[Phi] - \[Phi]t);

\[Psi]t=(1.` -6.879355020739502` e^2-7.994375131737166` e^4+2.187307258611359` e^6+0.43922940219133877` e^8+0.06441789637641454` e^10+0.012471671305257387` e^12+0.00148019487655366` e^14-2.365853456980951` e^16)/(1.` -4.7531189079327625` e^2+8.985497194528612` e^4-8.432829090835353` e^6+3.920783419409329` e^8-0.7202361047165594` e^10-0.00010228738397186567` e^12)  ;

\[Psi]e= 18816/55691 1/(e^2 OTS) (OTS(1-11/7 e^2)\[Phi] - (1-3/7 e^2)\[Phi]t)  +  16382/55691 OTS/e^2 (OTS \[Psi] - \[Psi]t)    ;
       
 
\[Zeta]t = (1. + 7.418039965068421*e^2 + 1.0296046232380363*e^4 - 2.9989914475202815*e^6 + 0.15642047595878208*e^8 + 0.03312815567570384*e^10 + 0.0013783384341867373*e^12)/
 (1. - 5.124351605625036*e^2 + 10.739215254142296*e^4 - 11.722707151358318*e^6 + 6.9777664337298955*e^8 - 2.1227338288810427*e^10 + 0.25283399403815277*e^12) ;      

\[Kappa]t = (1. + 9.978064442502987*e^2 + 8.61628894601797*e^4 - 2.9171306073211287*e^6 - 0.6638417390833188*e^8 + 0.03320593609378203*e^10)/
 (1. - 5.708393023168499*e^2 + 13.599086050353115*e^4 - 17.384957816681347*e^6 + 12.719930460175032*e^8 - 5.2157644204409745*e^10 + 1.0666675652890647*e^12 - 0.07659479357081678*e^14)   ;
 
 
\[Zeta]e = 924/19067 1/(e^2 OTS) (- OTS^3 \[Phi] + (1-5/11 e^2)\[Phi]t) + 12243/76268 OTS/e^2 (OTS \[Zeta] - \[Zeta]t) ;
\[Kappa]e = OTS/e^2 (OTS \[Kappa]-\[Kappa]t)(769/96-3059665/700566 Log[2]+8190315/1868176 Log[3])^-1;


var2= (32/5)*eta*e*x^4*(-(985/48)*Pi*x^(3/2)*\[Phi]e+Pi*x^(5/2)*((55691/1344)*\[Psi]e+(19067/126)*eta*\[Zeta]e)+x^3*((89789209/352800-(87419/630)*Log[2]+(78003/560)*Log[3]   )*\[Kappa]e -(769/96)*((16/3)*Pi^2-(1712/105)*N[EulerGamma]-(1712/105)*   Log[4*x^(3/2)/x00]   )*Fe));

    var=var1 + var2;
    Return[var];
    
    
];










End[];


EndPackage[];
